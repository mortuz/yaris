"use strict";function Pictor(t){var e=document.createElement("VIDEO");t&&(this.config=t,e.setAttribute("src",t.videoUrl),e.setAttribute("class","video-js vjs-fluid"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),e.setAttribute("id","js--video-player"),e.setAttribute("poster",t.posterUrl),video=e),this.video=e}window.HELP_IMPROVE_VIDEOJS=!1,Pictor.prototype.animationStart=function(t){var e={animation:"animationstart",OAnimation:"oAnimationStart",MozAnimation:"mozAnimationStart",WebkitAnimation:"webkitAnimationStart"};for(var n in e)if(void 0!==t.style[n])return e[n]}(document.createElement("div")),Pictor.prototype.animationEnd=function(t){var e={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in e)if(void 0!==t.style[n])return e[n];animateFinish()}(document.createElement("div")),Pictor.prototype.fetchData=function(t,e){var n=this;fetch(t).then(function(t){return t.json()}).then(function(t){n.data=t,e()})},Pictor.prototype.init=function(){var n=this,i=n.config;this.fetchData("data.json",function(){new Promise(function(t,e){n._handleRules(i.rules),t("done")}).then(function(){var t=document.getElementsByClassName("vjs-tech")[0];CHARLIE.setup(t)})}),$("#videoPlayerWrapper").append(n.video),n.myPlayer=videojs("js--video-player",{controls:!0,autoplay:!1,preload:!1}),$("#js--video-player").append('<button class="vjs-icon-replay"></button>'),n.isiOS()&&$(".vjs-fullscreen-control").hide(),n.isAndroid()&&$(".vjs-fullscreen-control").hide(),$(".vjs-fluid").append(textAnimationBlock),textAnimationBlock.classList.add("is-ready");n.myPlayer.el_.addEventListener("webkitfullscreenchange",function(){n.handleFullScreen.call(this,event)}),n.controlbarAtBottom(),n.iOSHotFix(),n.myPlayer.on("seeking",function(t){0<n.myPlayer.currentTime()&&n.myPlayer.currentTime(0)}),n.myPlayer.on("seeked",function(t){0<n.myPlayer.currentTime()&&n.myPlayer.currentTime(0)}),n.myPlayer.on("ended",function(){$(".button").addClass("button-opacity"),n.myPlayer.posterImage.show(),$(this.posterImage.contentEl()).show(),$(this.bigPlayButton.contentEl()).show(),n.myPlayer.currentTime(0),n.myPlayer.controlBar.hide(),n.myPlayer.bigPlayButton.show(),n.myPlayer.cancelFullScreen()}),n.myPlayer.on("play",function(){$(".button").removeClass("button-opacity"),n.myPlayer.posterImage.hide(),n.myPlayer.controlBar.show(),n.myPlayer.bigPlayButton.hide()})};var video,textAnimationBlock=document.getElementById("textAnimationBlock");Pictor.prototype.handleFullScreen=function(t){console.log("handleFullScreen",t),function(){if(!("orientation"in screen))return;matchMedia("(orientation: portrait) and (max-device-width: 768px)").matches&&screen.orientation.lock("landscape").then(function(){!function(){if(!("DeviceOrientationEvent"in window))return;var n;window.addEventListener("deviceorientation",function t(e){if(10<Math.abs(e.gamma)||Math.abs(e.beta)<10)return n,void(n="landscape");(Math.abs(e.gamma)<10||10<Math.abs(e.beta))&&"landscape"==n&&(screen.orientation.unlock(),window.removeEventListener("deviceorientation",t))})}()})}(),"orientation"in screen&&screen.orientation.addEventListener("change",function(){screen.orientation.type.startsWith("landscape")?videoPlayerWrapper.requestFullscreen?videoPlayerWrapper.requestFullscreen():video.webkitEnterFullscreen():document.fullscreenElement&&document.exitFullscreen()})},Pictor.prototype._handleRules=function(t){for(var e=0;e<t.length;e++){var n=t[e];this._createElem(n)}},Pictor.prototype._createElem=function(t){var e;e="a"==t.tag?document.createElement("a"):"span"==t.tag?document.createElement("span"):document.createElement("div");document.getElementById("textAnimationBlock");if(t.id&&e.setAttribute("id",t.id),t.href&&e.setAttribute("href",t.href),t.newWindow&&e.setAttribute("target","_blank"),t.animations&&e.setAttribute("data-animations",t.animations),t.times&&e.setAttribute("data-times",t.times),t.class&&e.setAttribute("class",t.class),t.target){var n=document.createTextNode(this.data[t.target]);e.appendChild(n)}if(t.text){n=document.createTextNode(t.text);e.appendChild(n)}t.parent?$(t.parent).append(e):$("#textAnimationBlock").append(e)},Pictor.prototype.isiOS=function(){return!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)},Pictor.prototype.isAndroid=function(){return-1<navigator.userAgent.toLowerCase().indexOf("android")},Pictor.prototype.controlbarAtBottom=function(){var t=$(".vjs-control-bar").height();$(".vjs-control-bar").css("bottom","-"+t+"px"),window.addEventListener("resize",this.controlbarAtBottom),window.addEventListener("orientationchange",this.controlbarAtBottom)},Pictor.prototype.iOSHotFix=function(){var t=this;console.log(t),t.myPlayer.on("pause",function(){t.isiOS()&&$(".charlie").each(function(){$(this).hasClass("animated")&&$(this).css("-webkit-transform",$(this).css("-webkit-transform"))})})};