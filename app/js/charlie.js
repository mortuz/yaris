function assert(n,t){if(!1==!!n)throw t||"Assertion failed"}(function(){var n=this,t=n._,o={},r=Array.prototype,e=Object.prototype,i=Function.prototype,a=r.push,u=r.slice,s=r.concat,f=e.toString,l=e.hasOwnProperty,c=r.forEach,h=r.map,m=r.reduce,p=r.reduceRight,d=r.filter,v=r.every,y=r.some,g=r.indexOf,A=r.lastIndexOf,w=Array.isArray,b=Object.keys,_=i.bind,E=function(n){return n instanceof E?n:this instanceof E?void(this._wrapped=n):new E(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=E),exports._=E):n._=E,E.VERSION="1.5.2";var S=E.each=E.forEach=function(n,t,e){if(null!=n)if(c&&n.forEach===c)n.forEach(t,e);else if(n.length===+n.length){for(var i=0,r=n.length;i<r;i++)if(t.call(e,n[i],i,n)===o)return}else{var a=E.keys(n);for(i=0,r=a.length;i<r;i++)if(t.call(e,n[a[i]],a[i],n)===o)return}};E.map=E.collect=function(n,i,r){var a=[];return null==n?a:h&&n.map===h?n.map(i,r):(S(n,function(n,t,e){a.push(i.call(r,n,t,e))}),a)};var k="Reduce of empty array with no initial value";E.reduce=E.foldl=E.inject=function(n,i,r,a){var o=2<arguments.length;if(null==n&&(n=[]),m&&n.reduce===m)return a&&(i=E.bind(i,a)),o?n.reduce(i,r):n.reduce(i);if(S(n,function(n,t,e){o?r=i.call(a,r,n,t,e):(r=n,o=!0)}),!o)throw new TypeError(k);return r},E.reduceRight=E.foldr=function(i,r,a,o){var u=2<arguments.length;if(null==i&&(i=[]),p&&i.reduceRight===p)return o&&(r=E.bind(r,o)),u?i.reduceRight(r,a):i.reduceRight(r);var s=i.length;if(s!==+s){var l=E.keys(i);s=l.length}if(S(i,function(n,t,e){t=l?l[--s]:--s,u?a=r.call(o,a,i[t],t,e):(a=i[t],u=!0)}),!u)throw new TypeError(k);return a},E.find=E.detect=function(n,i,r){var a;return x(n,function(n,t,e){if(i.call(r,n,t,e))return a=n,!0}),a},E.filter=E.select=function(n,i,r){var a=[];return null==n?a:d&&n.filter===d?n.filter(i,r):(S(n,function(n,t,e){i.call(r,n,t,e)&&a.push(n)}),a)},E.reject=function(n,i,r){return E.filter(n,function(n,t,e){return!i.call(r,n,t,e)},r)},E.every=E.all=function(n,i,r){i||(i=E.identity);var a=!0;return null==n?a:v&&n.every===v?n.every(i,r):(S(n,function(n,t,e){if(!(a=a&&i.call(r,n,t,e)))return o}),!!a)};var x=E.some=E.any=function(n,i,r){i||(i=E.identity);var a=!1;return null==n?a:y&&n.some===y?n.some(i,r):(S(n,function(n,t,e){if(a||(a=i.call(r,n,t,e)))return o}),!!a)};E.contains=E.include=function(n,t){return null!=n&&(g&&n.indexOf===g?-1!=n.indexOf(t):x(n,function(n){return n===t}))},E.invoke=function(n,t){var e=u.call(arguments,2),i=E.isFunction(t);return E.map(n,function(n){return(i?t:n[t]).apply(n,e)})},E.pluck=function(n,t){return E.map(n,function(n){return n[t]})},E.where=function(n,e,t){return E.isEmpty(e)?t?void 0:[]:E[t?"find":"filter"](n,function(n){for(var t in e)if(e[t]!==n[t])return!1;return!0})},E.findWhere=function(n,t){return E.where(n,t,!0)},E.max=function(n,r,a){if(!r&&E.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!r&&E.isEmpty(n))return-1/0;var o={computed:-1/0,value:-1/0};return S(n,function(n,t,e){var i=r?r.call(a,n,t,e):n;i>o.computed&&(o={value:n,computed:i})}),o.value},E.min=function(n,r,a){if(!r&&E.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!r&&E.isEmpty(n))return 1/0;var o={computed:1/0,value:1/0};return S(n,function(n,t,e){var i=r?r.call(a,n,t,e):n;i<o.computed&&(o={value:n,computed:i})}),o.value},E.shuffle=function(n){var t,e=0,i=[];return S(n,function(n){t=E.random(e++),i[e-1]=i[t],i[t]=n}),i},E.sample=function(n,t,e){return arguments.length<2||e?n[E.random(n.length-1)]:E.shuffle(n).slice(0,Math.max(0,t))};var R=function(t){return E.isFunction(t)?t:function(n){return n[t]}};E.sortBy=function(n,t,i){var r=R(t);return E.pluck(E.map(n,function(n,t,e){return{value:n,index:t,criteria:r.call(i,n,t,e)}}).sort(function(n,t){var e=n.criteria,i=t.criteria;if(e!==i){if(i<e||void 0===e)return 1;if(e<i||void 0===i)return-1}return n.index-t.index}),"value")};var j=function(u){return function(i,n,r){var a={},o=null==n?E.identity:R(n);return S(i,function(n,t){var e=o.call(r,n,t,i);u(a,e,n)}),a}};E.groupBy=j(function(n,t,e){(E.has(n,t)?n[t]:n[t]=[]).push(e)}),E.indexBy=j(function(n,t,e){n[t]=e}),E.countBy=j(function(n,t){E.has(n,t)?n[t]++:n[t]=1}),E.sortedIndex=function(n,t,e,i){for(var r=(e=null==e?E.identity:R(e)).call(i,t),a=0,o=n.length;a<o;){var u=a+o>>>1;e.call(i,n[u])<r?a=u+1:o=u}return a},E.toArray=function(n){return n?E.isArray(n)?u.call(n):n.length===+n.length?E.map(n,E.identity):E.values(n):[]},E.size=function(n){return null==n?0:n.length===+n.length?n.length:E.keys(n).length},E.first=E.head=E.take=function(n,t,e){if(null!=n)return null==t||e?n[0]:u.call(n,0,t)},E.initial=function(n,t,e){return u.call(n,0,n.length-(null==t||e?1:t))},E.last=function(n,t,e){if(null!=n)return null==t||e?n[n.length-1]:u.call(n,Math.max(n.length-t,0))},E.rest=E.tail=E.drop=function(n,t,e){return u.call(n,null==t||e?1:t)},E.compact=function(n){return E.filter(n,E.identity)};var N=function(n,t,e){return t&&E.every(n,E.isArray)?s.apply(e,n):(S(n,function(n){E.isArray(n)||E.isArguments(n)?t?a.apply(e,n):N(n,t,e):e.push(n)}),e)};E.flatten=function(n,t){return N(n,t,[])},E.without=function(n){return E.difference(n,u.call(arguments,1))},E.uniq=E.unique=function(e,i,n,t){E.isFunction(i)&&(t=n,n=i,i=!1);var r=n?E.map(e,n,t):e,a=[],o=[];return S(r,function(n,t){(i?t&&o[o.length-1]===n:E.contains(o,n))||(o.push(n),a.push(e[t]))}),a},E.union=function(){return E.uniq(E.flatten(arguments,!0))},E.intersection=function(n){var e=u.call(arguments,1);return E.filter(E.uniq(n),function(t){return E.every(e,function(n){return 0<=E.indexOf(n,t)})})},E.difference=function(n){var t=s.apply(r,u.call(arguments,1));return E.filter(n,function(n){return!E.contains(t,n)})},E.zip=function(){for(var n=E.max(E.pluck(arguments,"length").concat(0)),t=new Array(n),e=0;e<n;e++)t[e]=E.pluck(arguments,""+e);return t},E.object=function(n,t){if(null==n)return{};for(var e={},i=0,r=n.length;i<r;i++)t?e[n[i]]=t[i]:e[n[i][0]]=n[i][1];return e},E.indexOf=function(n,t,e){if(null==n)return-1;var i=0,r=n.length;if(e){if("number"!=typeof e)return n[i=E.sortedIndex(n,t)]===t?i:-1;i=e<0?Math.max(0,r+e):e}if(g&&n.indexOf===g)return n.indexOf(t,e);for(;i<r;i++)if(n[i]===t)return i;return-1},E.lastIndexOf=function(n,t,e){if(null==n)return-1;var i=null!=e;if(A&&n.lastIndexOf===A)return i?n.lastIndexOf(t,e):n.lastIndexOf(t);for(var r=i?e:n.length;r--;)if(n[r]===t)return r;return-1},E.range=function(n,t,e){arguments.length<=1&&(t=n||0,n=0),e=e||1;for(var i=Math.max(Math.ceil((t-n)/e),0),r=0,a=new Array(i);r<i;)a[r++]=n,n+=e;return a};var F=function(){};E.bind=function(e,i){var r,a;if(_&&e.bind===_)return _.apply(e,u.call(arguments,1));if(!E.isFunction(e))throw new TypeError;return r=u.call(arguments,2),a=function(){if(!(this instanceof a))return e.apply(i,r.concat(u.call(arguments)));F.prototype=e.prototype;var n=new F;F.prototype=null;var t=e.apply(n,r.concat(u.call(arguments)));return Object(t)===t?t:n}},E.partial=function(n){var t=u.call(arguments,1);return function(){return n.apply(this,t.concat(u.call(arguments)))}},E.bindAll=function(t){var n=u.call(arguments,1);if(0===n.length)throw new Error("bindAll must be passed function names");return S(n,function(n){t[n]=E.bind(t[n],t)}),t},E.memoize=function(t,e){var i={};return e||(e=E.identity),function(){var n=e.apply(this,arguments);return E.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},E.delay=function(n,t){var e=u.call(arguments,2);return setTimeout(function(){return n.apply(null,e)},t)},E.defer=function(n){return E.delay.apply(E,[n,1].concat(u.call(arguments,1)))},E.throttle=function(e,i,r){var a,o,u,s=null,l=0;r||(r={});var c=function(){l=!1===r.leading?0:new Date,s=null,u=e.apply(a,o)};return function(){var n=new Date;l||!1!==r.leading||(l=n);var t=i-(n-l);return a=this,o=arguments,t<=0?(clearTimeout(s),s=null,l=n,u=e.apply(a,o)):s||!1===r.trailing||(s=setTimeout(c,t)),u}},E.debounce=function(e,i,r){var a,o,u,s,l;return function(){u=this,o=arguments,s=new Date;var t=function(){var n=new Date-s;n<i?a=setTimeout(t,i-n):(a=null,r||(l=e.apply(u,o)))},n=r&&!a;return a||(a=setTimeout(t,i)),n&&(l=e.apply(u,o)),l}},E.once=function(n){var t,e=!1;return function(){return e||(e=!0,t=n.apply(this,arguments),n=null),t}},E.wrap=function(t,e){return function(){var n=[t];return a.apply(n,arguments),e.apply(this,n)}},E.compose=function(){var e=arguments;return function(){for(var n=arguments,t=e.length-1;0<=t;t--)n=[e[t].apply(this,n)];return n[0]}},E.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}},E.keys=b||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var e in n)E.has(n,e)&&t.push(e);return t},E.values=function(n){for(var t=E.keys(n),e=t.length,i=new Array(e),r=0;r<e;r++)i[r]=n[t[r]];return i},E.pairs=function(n){for(var t=E.keys(n),e=t.length,i=new Array(e),r=0;r<e;r++)i[r]=[t[r],n[t[r]]];return i},E.invert=function(n){for(var t={},e=E.keys(n),i=0,r=e.length;i<r;i++)t[n[e[i]]]=e[i];return t},E.functions=E.methods=function(n){var t=[];for(var e in n)E.isFunction(n[e])&&t.push(e);return t.sort()},E.extend=function(e){return S(u.call(arguments,1),function(n){if(n)for(var t in n)e[t]=n[t]}),e},E.pick=function(t){var e={},n=s.apply(r,u.call(arguments,1));return S(n,function(n){n in t&&(e[n]=t[n])}),e},E.omit=function(n){var t={},e=s.apply(r,u.call(arguments,1));for(var i in n)E.contains(e,i)||(t[i]=n[i]);return t},E.defaults=function(e){return S(u.call(arguments,1),function(n){if(n)for(var t in n)void 0===e[t]&&(e[t]=n[t])}),e},E.clone=function(n){return E.isObject(n)?E.isArray(n)?n.slice():E.extend({},n):n},E.tap=function(n,t){return t(n),n};var M=function(n,t,e,i){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof E&&(n=n._wrapped),t instanceof E&&(t=t._wrapped);var r=f.call(n);if(r!=f.call(t))return!1;switch(r){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var a=e.length;a--;)if(e[a]==n)return i[a]==t;var o=n.constructor,u=t.constructor;if(o!==u&&!(E.isFunction(o)&&o instanceof o&&E.isFunction(u)&&u instanceof u))return!1;e.push(n),i.push(t);var s=0,l=!0;if("[object Array]"==r){if(l=(s=n.length)==t.length)for(;s--&&(l=M(n[s],t[s],e,i)););}else{for(var c in n)if(E.has(n,c)&&(s++,!(l=E.has(t,c)&&M(n[c],t[c],e,i))))break;if(l){for(c in t)if(E.has(t,c)&&!s--)break;l=!s}}return e.pop(),i.pop(),l};E.isEqual=function(n,t){return M(n,t,[],[])},E.isEmpty=function(n){if(null==n)return!0;if(E.isArray(n)||E.isString(n))return 0===n.length;for(var t in n)if(E.has(n,t))return!1;return!0},E.isElement=function(n){return!(!n||1!==n.nodeType)},E.isArray=w||function(n){return"[object Array]"==f.call(n)},E.isObject=function(n){return n===Object(n)},S(["Arguments","Function","String","Number","Date","RegExp"],function(t){E["is"+t]=function(n){return f.call(n)=="[object "+t+"]"}}),E.isArguments(arguments)||(E.isArguments=function(n){return!(!n||!E.has(n,"callee"))}),"function"!=typeof/./&&(E.isFunction=function(n){return"function"==typeof n}),E.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},E.isNaN=function(n){return E.isNumber(n)&&n!=+n},E.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"==f.call(n)},E.isNull=function(n){return null===n},E.isUndefined=function(n){return void 0===n},E.has=function(n,t){return l.call(n,t)},E.noConflict=function(){return n._=t,this},E.identity=function(n){return n},E.times=function(n,t,e){for(var i=Array(Math.max(0,n)),r=0;r<n;r++)i[r]=t.call(e,r);return i},E.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var L={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};L.unescape=E.invert(L.escape);var O={escape:new RegExp("["+E.keys(L.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(L.unescape).join("|")+")","g")};E.each(["escape","unescape"],function(t){E[t]=function(n){return null==n?"":(""+n).replace(O[t],function(n){return L[t][n]})}}),E.result=function(n,t){if(null!=n){var e=n[t];return E.isFunction(e)?e.call(n):e}},E.mixin=function(e){S(E.functions(e),function(n){var t=E[n]=e[n];E.prototype[n]=function(){var n=[this._wrapped];return a.apply(n,arguments),q.call(this,t.apply(E,n))}})};var C=0;E.uniqueId=function(n){var t=++C+"";return n?n+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,T={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(a,n,t){var e;t=E.defaults({},t,E.templateSettings);var i=new RegExp([(t.escape||D).source,(t.interpolate||D).source,(t.evaluate||D).source].join("|")+"|$","g"),o=0,u="__p+='";a.replace(i,function(n,t,e,i,r){return u+=a.slice(o,r).replace(I,function(n){return"\\"+T[n]}),t&&(u+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),e&&(u+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),i&&(u+="';\n"+i+"\n__p+='"),o=r+n.length,n}),u+="';\n",t.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{e=new Function(t.variable||"obj","_",u)}catch(n){throw n.source=u,n}if(n)return e(n,E);var r=function(n){return e.call(this,n,E)};return r.source="function("+(t.variable||"obj")+"){\n"+u+"}",r},E.chain=function(n){return E(n).chain()};var q=function(n){return this._chain?E(n).chain():n};E.mixin(E),S(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];E.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],q.call(this,n)}}),S(["concat","join","slice"],function(n){var t=r[n];E.prototype[n]=function(){return q.call(this,t.apply(this._wrapped,arguments))}}),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),Date.now||(Date.now=function(){return(new Date).getTime()}),function(){for(var n=["webkit","moz"],t=0;t<n.length&&!window.requestAnimationFrame;++t){var e=n[t];window.requestAnimationFrame=window[e+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var i=0;window.requestAnimationFrame=function(n){var t=Date.now(),e=Math.max(i+16,t);return setTimeout(function(){n(i=e)},e-t)},window.cancelAnimationFrame=clearTimeout}}(),"undefined"==typeof document||"classList"in document.createElement("a")||function(n){if("HTMLElement"in n||"Element"in n){var t="classList",e="prototype",i=(n.HTMLElement||n.Element)[e],r=Object,a=String[e].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[e].indexOf||function(n){for(var t=0,e=this.length;t<e;t++)if(t in this&&this[t]===n)return t;return-1},u=function(n,t){this.name=n,this.code=DOMException[n],this.message=t},s=function(n,t){if(""===t)throw new u("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new u("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(n,t)},l=function(n){for(var t=a.call(n.className),e=t?t.split(/\s+/):[],i=0,r=e.length;i<r;i++)this.push(e[i]);this._updateClassName=function(){n.className=this.toString()}},c=l[e]=[],f=function(){return new l(this)};if(u[e]=Error[e],c.item=function(n){return this[n]||null},c.contains=function(n){return-1!==s(this,n+="")},c.add=function(){for(var n,t=arguments,e=0,i=t.length,r=!1;n=t[e]+"",-1===s(this,n)&&(this.push(n),r=!0),++e<i;);r&&this._updateClassName()},c.remove=function(){var n,t=arguments,e=0,i=t.length,r=!1;do{n=t[e]+"";var a=s(this,n);-1!==a&&(this.splice(a,1),r=!0)}while(++e<i);r&&this._updateClassName()},c.toggle=function(n,t){n+="";var e=this.contains(n),i=e?!0!==t&&"remove":!1!==t&&"add";return i&&this[i](n),!e},c.toString=function(){return this.join(" ")},r.defineProperty){var h={get:f,enumerable:!0,configurable:!0};try{r.defineProperty(i,t,h)}catch(n){-2146823252===n.number&&(h.enumerable=!1,r.defineProperty(i,t,h))}}else r[e].__defineGetter__&&i.__defineGetter__(t,f)}}(self),function(){window.CHARLIE={};var t,n,i,r,e,a=window.CHARLIE,o=window.CSSRule.KEYFRAMES_RULE||window.CSSRule.WEBKIT_KEYFRAMES_RULE||window.CSSRule.MOZ_KEYFRAMES_RULE||window.CSSRule.O_KEYFRAMES_RULE||window.CSSRule.MS_KEYFRAMES_RULE,u=["webkit","moz","o","ms"],s=function(e){var n=_.toArray(document.styleSheets),i=[];return _.forEach(n,function(n){var t=[];try{t=_.toArray(n.cssRules)}catch(n){}_.forEach(t,function(n){e(n)&&i.push(n)})}),i},l=function(n){return Math.round(10*n)/10},c=(e="",function(n){return e||(e=n.animationName?"animationName":n.webkitAnimationName?"webkitAnimationName":n.mozAnimationName?"mozAnimationName":n.oAnimationName?"oAnimationName":n.msAnimationName?"msAnimationName":"")}),f=(i="",t="animationDuration",(n=_.map(u,function(n){return n+t.substring(0,1).toUpperCase()+t.substring(1)})).push(t),r=n,function(n){if(!i)for(var t=0;t<r.length;t++){var e=r[t];if(n[e]){i=e;break}}return n[i]}),h=function(n,t){var e=(e=-(t-n.startsAt))<0?e:0,i=Math.floor(1e3*e)+"ms";n.element.style.webkitAnimationDelay=i,n.element.style.mozAnimationDelay=i,n.element.style.oAnimationDelay=i,n.element.style.msAnimationDelay=i,n.element.style.animationDelay=i},m=function(n,t){this.keyframes=n,this.cssRules=t};m.create=function(){var n=s(function(n){return o===n.type}),t=_.object(_.map(n,function(n){return[n.name,n]})),e=s(function(n){return n.style&&n.style[c(n.style)]}),i=_.object(_.map(e,function(n){return[n.selectorText.substring(1),n]}));return new m(t,i)},m.prototype={keyframes:{},cssRules:{}},a.CSSAnimations=m;var p,d=function(n,t,e,i){this.animations=n||{},this.bySeconds=t||{},this.running=[],this.paused=[],this.timeModel=e||{},this.callbacks=i||{}};d.prototype={animations:{},bySeconds:{},running:[],paused:[],timeModel:{},callbacks:{},startAnimations:function(n,t){var e=l(t),i=this;if(i.resumeAnimations(),i.bySeconds[e]){var r=i.bySeconds[e],a=_.filter(r,function(n){return!_.contains(i.running,n)});_.forEach(a,function(n){n.start(),i.running.push(n)})}},executeCallbacks:(p=0,function(n,t){var e=l(t);if(p<e||e<p){p=e;var i=this.callbacks[e]||[];_.forEach(i,function(n){n()})}}),seek:function(n,t){var e=this,i=l(n),r=function(n,t){for(var e=[],i=0;i<n.timeModel.length;i++){var r=n.timeModel[i];if(r.startsAt>t)break;r.endsAt>t&&e.push(r)}return e}(e,i);_.forEach(r,function(n){h(n,i),n.start(),t?e.running.push(n):(e.paused.push(n),n.pause())})},pauseAnimations:function(){for(var n;n=this.running.pop();)n.pause(),this.paused.push(n)},clearAnimations:function(){var n;for(this.resumeAnimations();n=this.running.pop();)n.reset();for(;n=this.paused.pop();)n.reset()},resumeAnimations:function(){for(var n;n=this.paused.pop();)n.resume(),this.running.push(n)},bind:function(n,t){var a,o,u;a=this,o=n,u=t,_.forEach(_.keys(u),function(e){var i=o.keyframes[e],r=o.cssRules[e];_.forEach(u[e],function(n){var t=new v(e,r,i,n.element,n.time);a.animations[e]=a.animations[e]||[],a.bySeconds[t.startsAt]=a.bySeconds[t.startsAt]||[],a.animations[e].push(t),a.bySeconds[t.startsAt].push(t)})});var e,i=_.flatten(_.values(this.animations));e=i,this.timeModel=_.sortBy(e,"endsAt"),this.callbacks=g}},a.AnimationController=d;var v=function(n,t,e,i,r){var a,o;assert(n,"You can't create an animation without a name"),assert(t,"No CSS rule defined for animation "+n),assert(e,"No keyframe defined for animation "+n),assert(i,"No element found. Animations must be bound to a DOM element."),assert(r,"No start time provided for the animation"),this.name=n,this.element=i,this.cssRule=t,this.keyframe=e,this.startsAt=l(Number(r)),this.duration=(a=t.style,o=f(a),(o=Number(o.substring(0,o.length-1)))||0),this.endsAt=this.startsAt+this.duration};v.prototype={name:"",element:null,cssRule:null,keyframe:null,startsAt:-1,duration:-1,endsAt:-1,ios:!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),start:function(){var n,t,e=this;this.animated="animated",e.element.classList.add(e.name),e.element.classList.add(e.animated),n=e.element,t=function(){e.reset()},n.addEventListener("webkitAnimationEnd",t,!1),n.addEventListener("mozAnimationEnd",t,!1),n.addEventListener("msAnimationEnd",t,!1),n.addEventListener("oAnimationEnd",t,!1),n.addEventListener("animationend",t,!1)},reset:function(){this.element.classList.remove(this.name),this.element.classList.remove(this.animated),this.element.offsetWidth=this.element.offsetWidth,h(this,0)},pause:function(){if(this.element.style.webkitAnimationPlayState="paused",this.element.style.mozAnimationPlayState="paused",this.element.style.oAnimationPlayState="paused",this.element.style.animationPlayState="paused",this.ios){if(video||document.querySelector("video")){var n=video.currentTime||document.querySelector("video").currentTime;h(this,n)}this.element.classList.add("js-pause-animation")}},resume:function(){this.element.style.webkitAnimationPlayState="running",this.element.style.mozAnimationPlayState="running",this.element.style.oAnimationPlayState="running",this.element.style.animationPlayState="running",this.ios&&this.element.classList.remove("js-pause-animation")}},a.Animation=v;var y=function(n){assert(n,"Can't create a BigLoop without an AnimationController"),this.controller=n};y.prototype={controller:null,video:null,running:!1,frameID:-1,bind:function(n){(this.video=n).addEventListener("play",this.start.bind(this),!1),n.addEventListener("ended",this.ended.bind(this),!1),n.addEventListener("pause",this.stop.bind(this),!1),n.addEventListener("seeked",this.seeked.bind(this),!1)},ended:function(){this.controller.clearAnimations()},seeked:function(){this.controller.clearAnimations(),this.controller.seek(this.video.currentTime,!this.video.paused)},tick:function(n){this.running&&(this.frameID=requestAnimationFrame(this.tick.bind(this)),this.controller.startAnimations(n,this.video.currentTime),this.controller.executeCallbacks(n,this.video.currentTime))},start:function(){this.running=!0,this.tick()},stop:function(){this.frameID&&(cancelAnimationFrame(this.frameID),this.frameID=-1),this.running=!1,this.controller.pauseAnimations()}};var g={};a.setup=function(n){var r,t=m.create(),e=(r={},_.forEach(document.getElementsByClassName("charlie"),function(i){var n=i.dataset.animations.split(/\s*,\s*/),t=i.dataset.times.split(/\s*,\s*/),e=_.zip(n,t);_.forEach(e,function(n){var t=n[0],e=n[1];r[t]=r[t]||[],r[t].push({element:i,time:e})})}),r),i=new d,a=new y(i);i.bind(t,e,g),a.bind(n)},a.addCallback=function(n,t){t=l(t);var e=g[t]||[];e.push(n),g[t]=e}}();